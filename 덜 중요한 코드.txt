less important codes
about 300lines